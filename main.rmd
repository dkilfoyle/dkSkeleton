---
title: "My Project"
bibliography: project.bib
csl: include/neurology.csl
---

```{r setup, echo=FALSE, warning=F, message=FALSE}
library(knitr)
opts_chunk$set(comment="") # remove the comment symbol from knitr output
opts_chunk$set(echo=F, fig.cap="")
opts_chunk$set(message=F, warning=F) # unless debugging

require(ggplot2)
require(dplyr)
require(tidyr)
require(ez)

options(scipen=3)
source("loadData.r")
source("r/table1.r")
source("r/PlotUtils.r")
source("r/ReportUtils.r")
```

#### {.abstract}

**Abstract** We studied the effect of x on y. *Methods*: Subjects were selected randomly and compared to controls. *Results*: There were N subjects aged x-y. The primary outcome occured in x% vs y% p=0.01. *Conclusion*: There was a significant effect.

# Background

Here I reference a paper [@Josephson2005].

# Methods

Bla bla bl

# Results

## Demographics

Cases and controls are well matched for age and gender. 

```{r results='asis'}
selectedFields = structure(c("numeric1", "numeric2", "2", "2"), .Dim = c(2L, 2L))
colOptions = structure(c("Case", "Control", "c", "c", "Subjects", "Subjects"), .Dim = 2:3)
cat(table1(mydata, "factor1", selectedFields, colOptions, 
           add_total_col = F, statistics = T, NEJMstyle = T, colN = T,
           caption="", caption.loc = "top", tfoot=""))
```

## Dataframe as table

```{r}
# ReportUtils options should insert automatic table numbering
htmlTable(x, align="ccc", caption="Mean OCT by Quadrant", tableCSSclass="gmisc_table60")
```

## 1 Numeric

histogram
normality

## 2 Numeric

```{r}
ggplot(mydata, aes(x=numeric1, y=numeric2)) +
  geom_point(shape=2) +
  geom_smooth(method="lm")
```

## 1 numeric by 2 level factor

```{r }
ggplot(mydata, aes(x=factor1, y=numeric1)) +
  geom_boxplot() #+
  #scale_x_discrete(labels=c("level1","level2")) +
  #guides(fill=guide_legend(title=NULL)) +
  #ylab("ylab")
```

```{r }
#t.test(numeric1 ~ factor1, data=mydata)
```

## 1 numeric by n level factor

anova

## Correlation Matrix

```{r fig.width=11, fig.height=11}
mydata %>%
  #filter(Case.Control=="Case") %>%
  select(numeric1, numeric2) %>%
  ezCor(., label_size=8)
```

## Normality Tests

```{r}
x1=ggplot(mydata, aes(x=numeric1)) +  geom_histogram()
x2=ggplot(mydata, aes(sample=numeric1)) + stat_qq()
multiplot(x1, x2, cols=2)
```

Shapiro-Wilk test = normal if p > 0.05. 

```{r}
shapiro.test(mydata$numeric1)
```

`r knit_child("child1.rmd")`

# Conclusion

# Bibliography
